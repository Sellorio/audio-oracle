@using MudBlazor.Interfaces
@using Sellorio.AudioOracle.Web.Client.Library.Providers.DisableState

@{
	bool isSubmitting = Form != null && Form.IsSubmitting;
}

<MudButton ButtonType="ButtonType.Button" Color="Color.Primary" Variant="Variant.Filled" OnClick="HandleClick" Disabled="Disabled || isSubmitting || DisableStateScope.IsDisabled">
	@Label

	@if (isSubmitting)
	{
		<MudProgressCircular Size="Size.Small" Indeterminate Style="margin-left:10px" />
	}
</MudButton>

@code {
	[CascadingParameter]
	public required IDisableStateScope DisableStateScope { get; set; }

	[CascadingParameter]
	public required AoForm Form { get; set; }

	[Parameter]
	public string? Label { get; set; }

	[Parameter]
	public bool Disabled { get; set; }

	[Parameter]
	public EventCallback OnClick { get; set; }

	async Task HandleClick()
	{
		if (Form != null)
		{
			await Form.OnSubmitAsync();
		}
	}
}
